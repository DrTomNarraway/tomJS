
<!DOCTYPE html>
<html>
<body>
    <script src="jatos.js" id="jatos"></script>
    <script src="tomJS.js" id="tomJS"></script>
    <script>

        const args = {
            'fullscreen': false,
            'gridlines': false,
            'verbose': true
        };

        const tomJS = new Experiment(args);

        if (jatos.constructor != HTMLScriptElement) jatos.onConnected(() => { tomJS.connectToJatos(false) });

        const _blockwise = {
            'fixation_colour': ['blue', 'orange']
        };

        const _trialwise = {
            'target': ['A', 'B'],
            'condition': [200, 400, 600]
        };

        const _conditional = {
            'fixation_duration': {
                'condition == 200': 1400,
                'condition == 400': 1200
            }
        };

        const _additional = {
            'difficulty': 0.03,
            'stimulus': Stimuli.Gabor,
            'ori': 2,
            'iti_duration': 1000,
            'signal': Stimuli.NecroDancerBar
        };

        const _keyboard = new Slides.Slide([
            { 'class': 'text', 'text': 'Please press F and then J a few times to make sure your', 'y': 0.25 },
            { 'class': 'text', 'text': 'keyboard is being read by the experiment correctly.', 'y': 0.30 },
            { 'class': 'text', 'text': '~tomJS.keyboard.key~', 'upper': true },
            { 'class': 'text', 'text': 'Press F and J to continue.', 'y': 0.75 },
        ]);

        const _end_block = new Slides.EndBlock([
            { 'class': 'text', 'text': 'End of block. Please take a short break.', 'y': 0.25 },
            { 'class': 'text', 'text': 'Your accuracy was great!', 'y': 0.48, 'conditions': ['~this.data.accuracy~ >= 80'] },
            { 'class': 'text', 'text': 'Your accuracy was good.', 'y': 0.48, 'conditions': ['~this.data.accuracy~ < 80', '~this.data.accuracy~ >= 60'] },
            { 'class': 'text', 'text': 'Your accuracy needs improvement.', 'y': 0.48, 'conditions': ['~this.data.accuracy~ < 60'] },
            { 'class': 'text', 'text': 'Your timing was great!', 'y': 0.52, 'conditions': ['~this.data.hits~ >= 80'] },
            { 'class': 'text', 'text': 'Your timing was good.', 'y': 0.52, 'conditions': ['~this.data.hits~ < 80', '~this.data.hits~ >= 60'] },
            { 'class': 'text', 'text': 'Your timing needs improvement.', 'y': 0.52, 'conditions': ['~this.data.hits~ < 60'] },
            { 'class': 'text', 'text': 'Press F and J to continue.', 'y': 0.75 },
        ]);

        const _end_exp = new Slides.EndExperiment([
            { 'class': 'text', 'text': 'End of Experiment. Thank you for your help.', 'y': 0.25 },
            { 'class': 'text', 'text': 'You were correct on ~this.data.accuracy~% of all test trials.', 'y': 0.48 },
            { 'class': 'text', 'text': 'You responded on time on ~this.data.hits~% of all test trials.', 'y': 0.52 },
            { 'class': 'text', 'text': 'Press F and J to end the experiment.', 'y': 0.75 },
        ]);

        tomJS.appendToTimeline(_keyboard);

        tomJS.appendBlocks(
            trial_type = Trials.ProgressBarResponseSignal,
            blockwise = _blockwise,
            trialwise = _trialwise,
            additional = _additional,
            conditional = {},
            attention = {},
            block_reps = 2,
            trial_reps = 2,
            start_slide = null,
            end_slide = _end_block,
            add_countdown = true
        );

        tomJS.appendToTimeline(_end_exp);

        tomJS.start();

    </script>
</body>
</html>
