
<!DOCTYPE html>
<html>
<body>
    <script src="jatos.js" id="jatos"></script>
    <script src="tomJS.js" id="tomJS"></script>
    <script>

        const _args = {'fullscreen':false};

        const tomJS = new Experiment(_args);

        const _blockwise = {}; 

        const _trialwise = {'condition':[200, 600], 'target':['A', 'B']};
        
        const _additional = { 'gp_ori': 2, 'stimulus': Gabor, 'difficulty':0.50 };

        const _conditional = {
            'fixation_duration': { 
                '~this.args.condition~ == 200': 1400,
            }
        };
        
        const _welcome = new Slide([
            {'class': 'text', 'text': 'DEBUG VERSION', 'y':0.25},
            {'class': 'text', 'text': '~tomJS.key~', 'upper': true},
            {'class': 'text', 'text': 'Press F and J to continue.', 'y': 0.75}
        ]);

        const _stars = new Slide([
            { 'class': 'text', 'text': 'This block uses a conventional response signal, appearing crosses.', 'y': 0.25 },
            { 'class': 'text', 'text': 'A single cross will warn that the row of crosses is about to appear.', 'y': 0.30 },
            { 'class': 'text', 'text': 'Respond while the row of crosses is on screen.', 'y': 0.35 },
            { 'class': 'text', 'text': 'Press F and J to continue.', 'y': 0.75 }
        ]);

        const _standard = new ExampleProgressBar([
            { 'class': 'text', 'text': 'This block uses the progress bar which grows from left to right.', 'y': 0.25 },
            { 'class': 'text', 'text': 'Respond when the bar turns blue.', 'y': 0.30 },
            { 'class': 'text', 'text': 'Press F and J to start.', 'y': 0.75 },
        ], { 'signal': ProgressBar, 'signal_on': 0.80, 'signal_off': 1.00 });

        const _leaky = new ExampleProgressBar([
            { 'class': 'text', 'text': 'This block uses a "leaky" bar which empties toward the center.', 'y': 0.25 },
            { 'class': 'text', 'text': 'Respond when the bar turns blue.', 'y': 0.30 },
            { 'class': 'text', 'text': 'Press F and J to start.', 'y': 0.75 },
        ], { 'signal': LeakyBar, 'signal_on': 0.80, 'signal_off': 1.00 });

        const _guitar = new ExampleProgressBar([
            { 'class': 'text', 'text': 'This block uses a "Guitar Hero" bar which has a "note" moving towards the "pick".', 'y': 0.25 },
            { 'class': 'text', 'text': 'Respond when the note is inside the pick area.', 'y': 0.30 },
            { 'class': 'text', 'text': 'Press F and J to start.', 'y': 0.75 },
        ], { 'signal': GuitarHeroBar, 'signal_on': 0.80, 'signal_off': 1.00 });

        const _end_block = new EndBlock([
            {'class': 'text', 'text': 'END OF BLOCK', 'y': 0.25},
            {'class': 'text', 'text': 'Accuracy: ~this.data.accuracy~', 'y':0.475},
            {'class': 'text', 'text': 'Hits: ~this.data.hits~', 'y':0.525 },
            {'class': 'text', 'text': 'Press F and J to continue.', 'y': 0.75}
        ]);

        const _end_exp = new EndExperiment([
            {'class': 'text', 'text': 'END OF EXPERIMENT', 'y': 0.25},
            { 'class': 'text', 'text': 'Accuracy: ~this.data.accuracy~', 'y': 0.475 },
            { 'class': 'text', 'text': 'Hits: ~this.data.hits~', 'y': 0.525 },
            {'class': 'text', 'text': 'Press F and J to continue.', 'y': 0.75}
        ]); 

        tomJS.appendToTimeline(_welcome);

        tomJS.appendToTimeline(_stars);
        tomJS.appendBlock(
            trial_type = ResponseSignal,
            trialwise = _trialwise,
            additional = _additional,
            conditional = _conditional,
            trial_reps = 1,
            start_slide = null,
            end_slide = _end_block,
            add_countdown = true
        );

        tomJS.appendToTimeline(_standard);
        tomJS.appendBlock(
            trial_type = ProgressBarResponseSignal,
            trialwise = _trialwise,
            additional = { ..._additional, ...{ 'signal': ProgressBar }},
            conditional = _conditional,
            trial_reps = 1,
            start_slide = null,
            end_slide = _end_block,
            add_countdown = true
        );

        tomJS.appendToTimeline(_leaky);
        tomJS.appendBlock(
            trial_type = ProgressBarResponseSignal,
            trialwise = _trialwise,
            additional = { ..._additional, ...{ 'signal': LeakyBar } },
            conditional = _conditional,
            trial_reps = 1,
            start_slide = null,
            end_slide = _end_block,
            add_countdown = true
        );

        tomJS.appendToTimeline(_guitar);
        tomJS.appendBlock(
            trial_type = ProgressBarResponseSignal,
            trialwise = _trialwise,
            additional = { ..._additional, ...{ 'signal': GuitarHeroBar } },
            conditional = _conditional,
            trial_reps = 1,
            start_slide = null,
            end_slide = _end_block,
            add_countdown = true
        );

        tomJS.replaceEndBlockWithEndExperiment(_end_exp);

        tomJS.start();

    </script>
</body>
</html>
